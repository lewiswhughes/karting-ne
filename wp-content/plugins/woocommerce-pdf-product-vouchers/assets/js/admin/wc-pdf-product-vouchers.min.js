"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){jQuery(function(l){var t,r,n,o,c,a,u,i,d,s,_,e,p,v,h,m,f,w,b,g;return p=null!=(v=window.wc_pdf_product_vouchers_admin)?v:{},null!=(h=window.typenow)?h:"",e=null!=(m=window.pagenow)?m:"",jQuery(document).ready(function(t){var r,e,c,o,n,a,u,i,d,s;return p.is_edit_voucher_page&&(n=t(".page-title-action").first(),d=t("<a></a>").attr("href",p.redeem_voucher_url).addClass("page-title-action").text(p.i18n.redeem_voucher),n.after(d)),s=t("#redeem-voucher"),i=t("#redeem-voucher-form"),u=t("#redemption-amount-row"),a=t("#redemption-amount"),r=t("#barcode-value"),s.on("click",function(e){return e.preventDefault(),i.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),o()}),i.on("submit",function(e){return e.preventDefault(),i.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),o()}),o=function(){return setTimeout(e,Math.floor(1e3*Math.random()+500))},e=function(){var e,o;if(!s.data("inProgress"))return r.val()?(s.data("inProgress",!0),e={action:"wc_pdf_product_vouchers_barcode_redeem_voucher",security:wc_pdf_product_vouchers_admin.barcode_redeem_voucher_nonce,barcode_value:r.val(),amount:a.val()},t.post(wc_pdf_product_vouchers_admin.ajax_url,e,c).always(function(){return i.unblock(),s.data("inProgress",!1)})):((o=t(".js-redeem-message")).addClass("hidden"),o.html("<p>"+wc_pdf_product_vouchers_admin.i18n.empty_barcode_error+"</p>").removeClass("notice-success notice-warning").addClass("notice-error"),o.removeClass("hidden"),r.focus(),void i.unblock())},c=function(e){var o;(o=t(".js-redeem-message")).addClass("hidden"),!0===e.success?!0===e.data.is_multi&&!0===e.data.missing_amount?(o.html("<p>"+e.data.message+"</p>").removeClass("notice-success notice-error").addClass("notice-warning"),a.attr("max",e.data.available),a.attr("value",e.data.available),a.attr("required",!0),u.show()):(r.val("").focus(),o.html("<p>"+e.data.message+"</p>").removeClass("notice-error notice-warning").addClass("notice-success"),a.attr("value",""),a.attr("required",!1),u.hide()):o.html("<p>"+e.data.message+"</p>").removeClass("notice-success notice-warning").addClass("notice-error"),o.removeClass("hidden")}}),s=function(){return l(document.body).trigger("init_tooltips")},"wc_voucher"!==e&&"edit-wc_voucher"!==e||(s(),l(".page-title-action, .add-new-h2").on("click",function(e){return e.preventDefault(),l(this).pointer("toggle")}).on("pointercreate",function(){var o,t;return o=l(this),(t=o.data("wp-pointer").pointer).on("click",".close",function(e){return e.preventDefault(),o.pointer("close")}),t.on("click",".button-primary",function(e){return e.preventDefault(),t.find("form").submit()})}).on("pointeropened",function(e,o){return o.pointer.find("input:first").focus(),l(document.body).trigger("wc-enhanced-select-init")}).pointer({pointerClass:"create-voucher-pointer",content:function(){var e;return e='<p><label for="search_product_id">'+p.i18n.product+'</label><select class="wc-product-search" name="product" id="search_product_id" style="width:100%" data-exclude="wc_pdf_product_vouchers_non_voucher_products" data-placeholder="'+p.i18n.search_for_product+'" data-allow_clear="true" ></select></p> <p><label for="search_product_id">'+p.i18n.purchaser+'</label><select class="wc-customer-search" name="customer" id="search_customer_id" style="width:100%" data-placeholder="'+p.i18n.guest+'" data-allow_clear="true" ></select></p>','<form method="get" action="'+p.new_voucher_url+'"> <input type="hidden" name="post_type" value="wc_voucher" /> <h3 class="wc-pdf-product-vouchers-voucher-create-voucher">'+p.i18n.select_product_and_purchaser+"</h3>"+e+"</form>"},buttons:function(){return l('<div> <a class="close wc-pdf-product-vouchers-redeem-voucher-pointer-close" href="#">'+p.i18n.cancel+'</a> <button class="button button-primary">'+p.i18n.add_voucher+"</button> </div>")}})),"wc_voucher"===e&&(l(".date-picker-field, .date-picker").datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0}),n={message:g=null,overlayCSS:{background:"#fff",opacity:.6}},t=l.WCBackboneModal.View,f=function(e,o){return l("#wc-backbone-modal-dialog .modal-close").trigger("click"),new t({target:e,string:o})},_=function(){var e,o;return(o=l("#customer_id").val())?(e={user_id:o,action:"wc_pdf_product_vouchers_get_customer_details",security:p.get_customer_details_nonce},l(".voucher-purchaser-details div.edit-details").block(n),l.get(wc_pdf_product_vouchers_admin.ajax_url,e,function(e){return e.success&&l.each(e.data,function(e,o){return l(":input#_purchaser_"+e).val(o).change()}),l(".voucher-purchaser-details div.edit-details").unblock()})):(window.alert(p.i18n.no_customer_selected),!1)},o=function(){return l('.voucher-purchaser-details :input[name^="_purchaser_"]').each(function(){var e;return e=(e=l(this).attr("name")).replace("_purchaser_","_recipient_"),l(":input#"+e).val(l(this).val()).change()})},r=wp.media.view.MediaFrame.Select.extend({browseRouter:function(e){return e.set({browse:{text:_wpMediaViewsL10n.mediaLibraryTitle,priority:20}})}}),l(document.body).on("wc_backbone_modal_loaded",function(e,o){if("wc-voucher-modal-edit-product"===o)return l(document.body).trigger("wc-enhanced-select-init"),l(document.body).on("change.edit-product-modal","#voucher_product_id",function(e){var o;return l("#modal_voucher_product_price").closest("p").block(n),o={action:"wc_pdf_product_vouchers_get_product_details",product_id:e.target.value,security:wc_pdf_product_vouchers_admin.get_product_details_nonce},l.get(wc_pdf_product_vouchers_admin.ajax_url,o,function(e){var o;if(e.success&&e.data)return g=e.data,o=window.accounting.format(g.price,2,null,woocommerce_admin.mon_decimal_point),l("#modal_voucher_product_price").val(o).closest("p").unblock()})})}).on("wc_backbone_modal_removed",function(e,o){if("wc-voucher-modal-edit-product"===o)return l(document.body).off("change.edit-product-modal")}).on("wc_backbone_modal_response",function(e,o,t){var r;return l("#wc-pdf-product-vouchers-voucher-balance").block(n),r={action:"wc_pdf_product_vouchers_update_voucher_product",security:wc_pdf_product_vouchers_admin.update_voucher_product_nonce,voucher_id:l("#post_ID").val(),product_id:t.product_id,product_price:t.product_price},l.post(wc_pdf_product_vouchers_admin.ajax_url,r,function(e){return e.success&&e.data&&(l("#wc-pdf-product-vouchers-voucher-balance .inside").html(e.data.balance_html),e.data.preview_html&&l("#wc-pdf-product-vouchers-voucher-preview .inside").html(e.data.preview_html),s()),l("#wc-pdf-product-vouchers-voucher-balance").unblock()})}).on("keyup",".js-wc-pdf-vouchers-redeem-amount",function(){var e,o,t;return o=window.accounting.unformat(l("#voucher_remaining_value_for_display").val(),woocommerce_admin.mon_decimal_point),e=window.accounting.unformat(l("#voucher_product_price_for_display").val(),woocommerce_admin.mon_decimal_point),t=l("#voucher_type").val(),b(l(this),o,e,t)}).on("blur",".js-wc-pdf-vouchers-redeem-amount",function(){return l(".wc_error_tip").fadeOut("100",function(){return l(this).remove()})}),l("a.edit-voucher-details").on("click",function(e){return e.preventDefault(),l(this).hide(),l(this).parent().find("a:not(.edit-voucher-details)").show(),l(this).closest(".voucher_data_column").find("div.view-details").hide(),l(this).closest(".voucher_data_column").find("div.edit-details").show()}),l("a.load-customer-details").on("click",function(e){if(e.preventDefault(),window.confirm(p.i18n.confirm_load_customer_details))return _()}),l("a.copy-purchaser-details").on("click",function(e){if(e.preventDefault(),window.confirm(p.i18n.confirm_copy_purchaser_details))return o()}),l("#customer_id").data("original_customer_id",l("#customer_id").val()).on("change",function(){return l(this).val()!==l(this).data("original_customer_id")?(l("button.js-calculate-tax-action, button.js-redeem-action").prop("disabled",!0),l(".js-customer-changed-notice").show()):(l("button.js-calculate-tax-action, button.js-redeem-action").prop("disabled",!1),l(".js-customer-changed-notice").hide())}).change(),l("#wc-pdf-product-vouchers-voucher-notes").on("click",".js-add-note",function(e){var o,t;if(e.preventDefault(),t=l("textarea#voucher-note").val())return l("#wc-pdf-product-vouchers-voucher-notes").block(n),o={action:"wc_pdf_product_vouchers_add_voucher_note",voucher_id:l("#post_ID").val(),note:t,notify:l("#note-notify").is(":checked"),security:wc_pdf_product_vouchers_admin.add_voucher_note_nonce},l.post(wc_pdf_product_vouchers_admin.ajax_url,o,function(e){return e.data&&(e.success?l("ul.voucher-notes").prepend(e.data.note_html).find("ul.no-notes").hide():alert(e.data)),l("#wc-pdf-product-vouchers-voucher-notes").unblock(),l("textarea#voucher-note").val("")})}).on("click","a.js-delete-note",function(e){var o,t;return e.preventDefault(),t=l(this).closest("li.note"),l(t).block(n),o={action:"wc_pdf_product_vouchers_delete_voucher_note",note_id:l(t).attr("rel"),security:wc_pdf_product_vouchers_admin.delete_voucher_note_nonce},l.post(wc_pdf_product_vouchers_admin.ajax_url,o,function(e){if(l(t).remove(),l("ul.voucher-notes").find("li:not(.no-notes)").length<1)return l("ul.voucher-notes").find("li.no-notes").show()})}),l("#wc-pdf-product-vouchers-voucher-balance").on("click",".js-edit-voucher-product",function(e){return e.preventDefault(),f("wc-voucher-modal-edit-product",{product_id:l('input[name="_product_id"]').val(),product_title:l(".product .wc-voucher-item-name").text(),product_price:l('input[name="_product_price"]').val()})}).on("click",".js-edit-voucher-redemption",function(e){return e.preventDefault(),l(this).closest("tr").find(".view").hide(),l(this).closest("tr").find(".edit").show(),l("div.wc-voucher-data-row.wc-voucher-edit-redemption-actions").slideDown(),l("div.wc-voucher-data-row-toggle").not("div.wc-voucher-data-row.wc-voucher-edit-redemption-actions").slideUp(),l("div.wc-voucher-data-row.wc-voucher-edit-redemption-actions button.js-cancel-action").attr("data-reload",!0),l("div.wc-voucher-totals-wrapper").slideDown(),l(this).hide()}).on("click",".js-redeem-action",function(e){return e.preventDefault(),l("div.wc-voucher-data-row.wc-voucher-redeem-actions").slideDown(),l("div.wc-voucher-data-row-toggle").not("div.wc-voucher-data-row.wc-voucher-redeem-actions").slideUp(),l("div.wc-voucher-totals-wrapper").slideUp(),l("div.wc-voucher-redeem-wrapper").slideDown(),l(".edit-voucher-item").hide()}).on("click",".js-void-action",function(e){return e.preventDefault(),l("div.wc-voucher-data-row.wc-voucher-void-actions").slideDown(),l("div.wc-voucher-data-row-toggle").not("div.wc-voucher-data-row.wc-voucher-void-actions").slideUp(),l("div.wc-voucher-totals-wrapper").slideUp(),l("div.wc-voucher-void-wrapper").slideDown(),l(".edit-voucher-item").hide()}).on("click",".js-calculate-tax-action",function(e){var o;if(e.preventDefault(),window.confirm(p.i18n.confirm_calculate_taxes))return l("#wc-pdf-product-vouchers-voucher-balance").block(n),o={action:"wc_pdf_product_vouchers_calculate_voucher_product_tax",security:wc_pdf_product_vouchers_admin.voucher_balance_nonce,voucher_id:l("#post_ID").val()},l.post(wc_pdf_product_vouchers_admin.ajax_url,o,u)}).on("click",".js-delete-voucher-redemption",function(e){var o;if(e.preventDefault(),window.confirm(p.i18n.confirm_delete_redemption))return l("#wc-pdf-product-vouchers-voucher-balance").block(n),o={action:"wc_pdf_product_vouchers_delete_voucher_redemption",security:wc_pdf_product_vouchers_admin.voucher_balance_nonce,voucher_id:l("#post_ID").val(),redemption_key:l(e.target).closest("tr").data("key")},l.post(wc_pdf_product_vouchers_admin.ajax_url,o,u)}).on("click",".js-cancel-action",function(e){var o,t;if(l("div.wc-voucher-data-row-toggle").not("div.wc-voucher-balance-actions").slideUp(),l("div.wc-voucher-balance-actions").slideDown(),l("div.wc-voucher-totals-wrapper").slideDown(),l(".edit-voucher-item").show(),"true"===(o=l(this)).attr("data-reload"))return l("#wc-pdf-product-vouchers-voucher-balance").block(n),t={action:"wc_pdf_product_vouchers_load_voucher_redemptions",security:wc_pdf_product_vouchers_admin.voucher_balance_nonce,voucher_id:l("#post_ID").val()},l.post(wc_pdf_product_vouchers_admin.ajax_url,t,function(e){return e.success&&e.data&&(l("tbody#voucher-redemptions").replaceWith(e.data.redemptions_html),s(),o.attr("data-reload","false")),l("#wc-pdf-product-vouchers-voucher-balance").unblock()})}).on("click",".js-redeem-voucher-action",function(e){var o,t,r,c;return e.preventDefault(),c=l("#voucher_value").val(),r=l("#voucher_tax").val(),t=(t=l("#redemption_amount").val())&&0<t.length?parseFloat(window.accounting.unformat(t,woocommerce_admin.mon_decimal_point)):t,r&&c&&t&&"incl"===wc_pdf_product_vouchers_admin.tax_display_shop&&(t/=1+(0<(r=parseFloat(r))?parseFloat(r/c):0)),o={action:"wc_pdf_product_vouchers_redeem_voucher",security:wc_pdf_product_vouchers_admin.voucher_balance_nonce,voucher_id:l("#post_ID").val(),amount:window.accounting.unformat(t,woocommerce_admin.mon_decimal_point),notes:l("#redemption_notes").val()},l("#wc-pdf-product-vouchers-voucher-balance").block(n),l.post(wc_pdf_product_vouchers_admin.ajax_url,o,u)}).on("click",".js-void-voucher-action",function(e){var o;if(e.preventDefault(),window.confirm(p.i18n.confirm_void_voucher))return l("#wc-pdf-product-vouchers-voucher-balance").block(n),o={action:"wc_pdf_product_vouchers_void_voucher",security:wc_pdf_product_vouchers_admin.voucher_balance_nonce,voucher_id:l("#post_ID").val(),reason:l("#void_reason").val()},l.post(wc_pdf_product_vouchers_admin.ajax_url,o,u)}).on("click",".js-restore-action",function(e){var o;if(e.preventDefault(),window.confirm(p.i18n.confirm_restore_voucher))return l("#wc-pdf-product-vouchers-voucher-balance").block(n),o={action:"wc_pdf_product_vouchers_restore_voucher",security:wc_pdf_product_vouchers_admin.voucher_balance_nonce,voucher_id:l("#post_ID").val()},l.post(wc_pdf_product_vouchers_admin.ajax_url,o,u)}).on("click",".js-save-redemptions-action",function(e){var o,t,r;return e.preventDefault(),t=l("tbody#voucher-redemptions :input[name]").serializeArray(),"incl"===wc_pdf_product_vouchers_admin.tax_display_shop&&l("#voucher_tax").val()&&(r=l("#voucher_tax").val()/l("#voucher_value").val(),t.forEach(function(e,o){if(0<e.name.lastIndexOf("[amount]"))return t[o].value=e.value/(1+r)})),o={action:"wc_pdf_product_vouchers_save_voucher_redemptions",security:wc_pdf_product_vouchers_admin.voucher_balance_nonce,voucher_id:l("#post_ID").val(),data:l.param(t)},l("#wc-pdf-product-vouchers-voucher-balance").block(n),l.post(wc_pdf_product_vouchers_admin.ajax_url,o,u)}),c=null,a=l("#_voucher_image_options").val(),l("#wc-pdf-product-vouchers-voucher-preview").on("click",".js-select-voucher-image",function(e){var o,t;if(e.preventDefault(),t=_wpMediaViewsL10n,o=l("#_voucher_image_options").val(),!c||a!==o)return a=o,(c=new r({button:{text:t.chooseImage},states:new wp.media.controller.Library({title:t.chooseImage,library:wp.media.query({type:"image",include:a.split(",")}),multiple:!1,searchable:!1,date:!1,content:"browse"})})).on("open",function(){var e,o;return o=c.state().get("selection"),e=l("#_thumbnail_id").val(),o.add(wp.media.attachment(e))}),c.on("select",function(){var e,o;if((o=c.state().get("selection").first().toJSON())&&o.id)return e={voucher_id:l("#post_ID").val(),image_id:o.id,action:"wc_pdf_product_vouchers_get_voucher_preview",security:p.get_voucher_preview_nonce},l("#wc-pdf-product-vouchers-voucher-preview .inside").block(n),l.get(wc_pdf_product_vouchers_admin.ajax_url,e,function(e){return e.success&&l("#wc-pdf-product-vouchers-voucher-preview .inside").html(e.data.preview_html),l("#wc-pdf-product-vouchers-voucher-preview .inside").unblock()})}),c.open();c.open()})),"edit-wc_voucher"===e&&(l(".js-filter-voucher-template").select2(),l(".redeem").on("click",function(e){return e.preventDefault(),l(this).pointer("toggle")}).on("pointercreate",function(){var o,t,e,r,c,n,a;return o=l(this),t=o.data("wp-pointer").pointer,a=o.closest(".voucher_actions").find(".voucher-type").val(),e=o.closest(".voucher_actions").find(".voucher-product-price-for-display").val(),n=o.closest(".voucher_actions").find(".voucher-value").val(),c=o.closest(".voucher_actions").find(".voucher-tax").val(),r=o.closest(".voucher_actions").find(".voucher-remaining-value-for-display").val(),t.data("voucher-type",a),t.data("voucher-product-price",e),t.data("voucher-value",n),t.data("voucher-tax",c),t.data("voucher-remaining-value",r),t.on("submit","form",function(e){return e.preventDefault(),i(t)}),t.on("click",".button-primary",function(e){return e.preventDefault(),i(t)}),t.on("click",".close",function(e){return e.preventDefault(),o.pointer("close")})}).on("pointeropened",function(e,o){return o.pointer.find("input:first").focus()}).pointer({pointerClass:"redeem-voucher-pointer",position:{edge:"top",at:"center bottom",my:"right+63 top"},content:function(){var e,o,t;return t=(e=l(this)).attr("href"),o=e.closest("p").find(".voucher-remaining-value-for-display").val(),'<form method="get" action="'+t+'"> <h3 class="wc-pdf-product-vouchers-voucher-redeem-voucher">'+p.i18n.redeem_voucher+"</h3> <p> <label>"+p.i18n.amount_label+'<input type="text" name="amount" class="large-text js-wc-pdf-vouchers-redeem-amount" value="'+window.accounting.format(o,2,null,woocommerce_admin.mon_decimal_point)+'" /> </label> </p> <p> <label>'+p.i18n.notes_label+'<textarea name="notes" class="large-text"></textarea> </label> </p> </form>'},buttons:function(){return l('<div> <a class="close wc-pdf-product-vouchers-redeem-voucher-pointer-close" href="#">'+p.i18n.cancel+'</a> <button class="button button-primary">'+p.i18n.redeem+"</button> </div>")}}),l(document.body).on("keyup",".js-wc-pdf-vouchers-redeem-amount",function(){var e;return e=l(this).closest(".redeem-voucher-pointer"),b(l(this),e.data("voucher-remaining-value"),e.data("voucher-product-price"),e.data("voucher-type"))}).on("blur",".js-wc-pdf-vouchers-redeem-amount",function(){return l(".wc_error_tip").fadeOut("100",function(){return l(this).remove()})}),l(".void").on("click",function(e){return e.preventDefault(),l(this).pointer("toggle")}).on("pointercreate",function(){var o,t;return o=l(this),(t=o.data("wp-pointer").pointer).on("submit","form",function(e){return e.preventDefault(),d(t)}),t.on("click",".button-primary",function(e){return e.preventDefault(),setTimeout(function(){return d(t)},0)}),t.on("click",".close",function(e){return e.preventDefault(),o.pointer("close")})}).on("pointeropened",function(e,o){return o.pointer.find("input:first").focus()}).pointer({pointerClass:"void-voucher-pointer",position:{edge:"top",at:"center bottom",my:"right+63 top"},content:function(){var e,o;return o=(e=l(this)).attr("href"),e.closest("p").find(".voucher-remaining-value").val(),'<form method="get" action="'+o+'"> <h3 class="wc-pdf-product-vouchers-voucher-void-voucher">'+p.i18n.void_remaining_value+"</h3> <p> <label>"+p.i18n.reason_label+'<textarea name="notes" class="large-text"></textarea> </label> </p> </form>'},buttons:function(){return l('<div> <a class="close wc-pdf-product-vouchers-void-voucher-pointer-close" href="#">'+p.i18n.cancel+'</a> <button class="button button-primary">'+p.i18n.void+"</button> </div>")}})),"product"===e&&(w=function(){var e;if(e=l("input#_has_voucher:checked").length,l(".hide_if_has_voucher").show(),l(".show_if_has_voucher").hide(),e)return l(".show_if_has_voucher").show()},l(document.body).on("woocommerce-product-type-change",function(e,o){return"variable"!==o&&"grouped"!==o&&"external"!==o&&"variable-subscription"!==o||l("input#_has_voucher").prop("checked",!1).change(),w()}),l("input#_has_voucher").on("change",function(){return w()}),l("input#_has_voucher").change(),l("#variable_product_options").on("change","input.variable_has_voucher",function(){if(l(this).closest(".woocommerce_variation").find(".show_if_variation_has_voucher").hide(),l(this).is(":checked"))return l(this).closest(".woocommerce_variation").find(".show_if_variation_has_voucher").show()}),l("input.variable_has_voucher").change(),l("#woocommerce-product-data").on("woocommerce_variations_loaded",function(e,o){if(!(o=o||!1))return l("input.variable_has_voucher").change()})),l.extend(woocommerce_admin,{pdf_product_vouchers_i18n_amount_greater_than_zero_error:p.i18n.amount_greater_than_zero_error,pdf_product_vouchers_i18n_amount_less_or_equal_to_remaining_error:p.i18n.amount_less_or_equal_to_remaining_error,pdf_product_vouchers_i18n_amount_multiple_of_product_price_error:p.i18n.amount_multiple_of_product_price_error}),b=function(o,e,t,r){var c,n,a,u,i,d,s=2<arguments.length&&void 0!==t?t:null,_=3<arguments.length&&void 0!==r?r:"multi";return u=new RegExp("[^0-9\\"+woocommerce_admin.mon_decimal_point+"]+","gi"),a=(d=o.val()).replace(u,""),c=parseFloat(window.accounting.unformat(d,woocommerce_admin.mon_decimal_point)),n=(i=[{error:"i18n_mon_decimal_error",invalid:d!==a},{error:"pdf_product_vouchers_i18n_amount_multiple_of_product_price_error",invalid:"single"===_&&c%s},{error:"pdf_product_vouchers_i18n_amount_greater_than_zero_error",invalid:!c||c<0},{error:"pdf_product_vouchers_i18n_amount_less_or_equal_to_remaining_error",invalid:e<c}]).filter(function(e){return e.invalid}),i.filter(function(e){return!e.invalid}).forEach(function(e){return n.length?o.parent().find(".wc_error_tip."+e.error).remove():l(document.body).triggerHandler("wc_remove_error_tip",[o,e.error])}),!n.length||(l(document.body).triggerHandler("wc_add_error_tip",[o,n.shift().error]),!1)},i=function(a){var u;return u=a.find('input[name="amount"]'),setTimeout(function(){var e,o,t,r,c,n;return b(u,a.data("voucher-remaining-value"),a.data("voucher-product-price"),a.data("voucher-type"))?(c=(e=a.find("form")).attr("action"),n=a.data("voucher-value"),t=a.data("voucher-tax"),(o={amount:e.find('input[name="amount"]').val(),notes:e.find('input[name="notes"], textarea[name="notes"]').val()}).amount=parseFloat(window.accounting.unformat(o.amount,woocommerce_admin.mon_decimal_point)),"incl"===wc_pdf_product_vouchers_admin.tax_display_shop&&t&&(r=t/n,o.amount=o.amount/(1+r)),c=c+"&"+l.param(o),window.location.href=c):u.focus()})},d=function(e){var o,t;return t=(t=(o=e.find("form")).attr("action"))+"&"+o.serialize(),window.location.href=t},u=function(e){var o,t;return"object"!==(void 0===e?"undefined":_typeof(e))||e.success?e.success&&e.data&&(t=e.data,l("#wc-pdf-product-vouchers-voucher-balance .inside").html(t.balance_html),o=l("#post_status").val().replace("wcpdf-",""),t.status&&t.status!==o&&(l("#post_status").val("wcpdf-"+t.status).change(),t.notes_html&&l("#wc-pdf-product-vouchers-voucher-notes ul.voucher-notes").replaceWith(t.notes_html)),s()):alert(e.data.message),l("#wc-pdf-product-vouchers-voucher-balance").unblock()}})}).call(void 0);