!function(c){function e(e){for(var t,n,i=e[0],o=e[1],a=e[2],r=0,s=[];r<i.length;r++)n=i[r],d[n]&&s.push(d[n][0]),d[n]=0;for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(c[t]=o[t]);for(m&&m(e);s.length;)s.shift()();return l.push.apply(l,a||[]),u()}function u(){for(var e,t=0;t<l.length;t++){for(var n=l[t],i=!0,o=1;o<n.length;o++){var a=n[o];0!==d[a]&&(i=!1)}i&&(l.splice(t--,1),e=r(r.s=n[0]))}return e}var n={},d={3:0},l=[];function r(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return c[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=c,r.c=n,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var t=window.webpackJsonp=window.webpackJsonp||[],i=t.push.bind(t);t.push=e,t=t.slice();for(var o=0;o<t.length;o++)e(t[o]);var m=i;l.push([148,1,0]),u()}({140:function(e,t){window.onscroll=function(){!function(){if(0<document.getElementsByClassName("preload").length){var e=document.getElementsByClassName("preload"),t=Array.from(e);if(0<e.length){var n=document.getElementsByClassName("preload")[0].parentNode,i=n.clientHeight,o=n.getBoundingClientRect().bottom;o-i/2<window.innerHeight&&function e(t,n,i){n<i&&(t[n].classList.remove("preload"),setTimeout(function(){e(t,n+1,i)},200))}(t,0,e.length)}}}()}},141:function(e,t){function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e,n,t){var i=null,o=0;a(n.childNodes).forEach(function(e,t){"card-container"==e.className&&(i=n.childNodes[t],o=i.clientWidth)}),t||(o*=-1),i.scroll({top:0,left:parseInt(i.scrollLeft,10)+o,behavior:"smooth"})}a(document.getElementsByClassName("card-carousel")).forEach(function(n){a(n.childNodes).forEach(function(e,t){"next-card"==e.className&&n.childNodes[t].addEventListener("click",function(e){i(0,n,!0)});"last-card"==e.className&&n.childNodes[t].addEventListener("click",function(e){i(0,n,!1)})})})},142:function(e,t){},143:function(e,t){function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}if(0<document.getElementsByClassName("kne-main-splash").length){var r=function(e,t,n){var i=null;return o(e.childNodes).forEach(function(e){"tag"==n?e.tagName.toLowerCase()==t&&(i=e):e.classList.contains(t)&&(i=e)}),i};o(document.getElementsByClassName("kne-main-splash")).forEach(function(t){var e=r(t,"button-container","class"),n=r(e,"play","class"),i=r(t,"video-container","class"),o=r(i,"video","tag"),a=r(i,"stop","class");o.addEventListener("ended",function(e){t.classList.remove("play")}),n.addEventListener("click",function(e){t.classList.add("play"),o.play()}),a.addEventListener("click",function(e){t.classList.remove("play"),o.pause()})})}0<document.getElementsByClassName("top-video-container").length&&o(document.getElementsByClassName("top-video-container")).forEach(function(t){o(t.childNodes).forEach(function(e){e.classList.contains("play")&&e.addEventListener("click",function(){t.classList.add("active")}),e.classList.contains("video-container")&&o(e.childNodes).forEach(function(e){e.classList.contains("closeModal")&&e.addEventListener("click",function(){t.classList.remove("active")})})})})},144:function(e,t){function n(e){for(var t=document.getElementsByClassName("activity_button"),n=0;n<t.length;n++){var i=t[n],o=i.getAttribute("href");i.classList.remove("active"),e==o&&i.classList.add("active")}}var i=window.location.hash,o=window.location.pathname;i.replace("#",""),n(o+i);var a,r=document.getElementsByClassName("activity_button");(a=r,function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(a)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()).forEach(function(e){e.addEventListener("click",function(e){n(e.currentTarget.pathname+e.currentTarget.hash)})})},148:function(e,t,n){"use strict";n.r(t);n(149),n(168),n(140),n(13),n(141),n(142),n(143),n(144);var i=n(0),c=n.n(i),a=n(8),r=n(6),s=n(7),u=n(11),d=n(5),l=n(3),m=n(9),h=n(2);function o(e){this.reservations={},this.cart=e,this.countdown={timer:null},this.removeButtons=null,this.setRemoveButtons(),this.constructReservations()}o.prototype.constructReservations=function(){var e=(new l.a).retrieve("reservations");if(e)for(var t=Object.keys(e.items),n=0;n<t.length;n++){var i=t[n],o=e.items[i];this.reservations[i]=this.constructReservation(o)}},o.prototype.constructReservation=function(e){var t=new u.a(e.check.checkId,e.check.customerId,e.check.type,e.check.status,e.check.name,e.check.total,e.check.notes,e.check.openedDate),n=null;e.event&&(n=new s.a(e.event.eventDesc,e.event.eventDuration,e.event.eventId,e.event.eventScheduledTime,e.event.eventTypeId,e.event.eventTypeName,e.event.reservationId,e.event.trackNo,e.event.eventHeatTypes));var i=new r.a(e.eventReservation.eventReservationId,e.eventReservation.description,e.eventReservation.endTime,e.eventReservation.eventTypeId,e.eventReservation.minNoOfAdultsPerBooking,e.eventReservation.minNoOfCadetsPerBooking,e.eventReservation.noOfCadetRacers,e.eventReservation.noOfRacers,e.eventReservation.noOfTotalRacers,e.eventReservation.notes,e.eventReservation.startTime,e.eventReservation.status,e.eventReservation.subject,e.eventReservation.externalSystemId,e.typeId,e.eventReservation.hidden),o=null;return e.induction&&(o=new r.a(e.induction.eventReservationId,e.induction.description,e.induction.endTime,e.induction.eventTypeId,e.induction.minNoOfAdultsPerBooking,e.induction.minNoOfCadetsPerBooking,e.induction.noOfCadetRacers,e.induction.noOfRacers,e.induction.noOfTotalRacers,e.induction.notes,e.induction.startTime,e.induction.status,e.induction.subject,e.induction.externalSystemId,e.induction.typeId,null)),new a.a(e.reservationId,e.wcProductId,e.created,e.eventTypeId,t,e.checkDetails,e.customer,n,i,e.eventReservationLink,e.status,e.wcEventTitle,o)},o.prototype.setRemoveButtons=function(){var e=document.getElementsByClassName("kne-remove-cart-item");this.removeButtons=Array.from(e),this.removeButtons.forEach(function(e){var t=this;e.addEventListener("click",function(e){t.triggerRemoveFromButton(e)})}.bind(this))},o.prototype.triggerRemoveFromButton=function(e){var t=e.target,n=t.getAttribute("data-remove-url"),i=t.getAttribute("data-reservation-id");t.getAttribute("data-event-res-id"),t.getAttribute("data-check-id");this.removeItemFromCart(i).then(function(e){window.location.href=n}).catch(function(e){console.error(e),window.location.href=n})},o.prototype.removeItemFromCart=function(e){return new Promise(function(t,n){console.info("removing item...");Object(m.a)(!0,!0,null);var i=this.reservations[e],o=new d.a;i?(console.info(i),fetch("".concat(appServerUrl,"/api/v1/log-clear-cart/").concat(e,"-").concat(i.eventReservation.eventReservationId,"-").concat(i.check.checkId,"-").concat(i.customer.email)).then(function(e){console.log(e)}),i.check.voidCheck(o).then(function(e){return i.eventReservation.removeCheck(i.check.checkId,o)}).then(function(e){return 0<e||2!==i.eventReservation.userId||new Promise(function(t,n){i.event.removeEventOnApi(o).then(function(e){return i.eventReservation.setStatus(4,o)}).then(function(e){t(!0)}).catch(function(e){n(e)})})}).then(function(e){i.setStatusCancelled(),t(!0)}).catch(function(e){n(e)})):console.warning("Warning: No reservation found in storage!!!")}.bind(this))},o.prototype.getLastAddedTime=function(){var i=null,e=null;this.cart&&(Object.keys(this.cart).forEach(function(e){var t=this.cart[e];if(void 0!==t["added-to-cart"]){var n=c()(t["added-to-cart"],"YYYY-MM-DD HH:mm:ss");i<n&&(i=n)}}.bind(this)),i&&(e=i.add(10,"m")));return e},o.prototype.countdownNext=function(e,t,n){if(t){var i=c()(),o=t.diff(i,"s"),a=Math.floor(o/60),r=o%60<10?"0"+o%60:o%60;0<o?e.innerHTML="You have "+a+" mins and "+r+' seconds to &nbsp; <a href="/cart">checkout</a>':(clearInterval(this.timer),e.innerHTML='Your cart items have been cleared - please &nbsp; <a href="/booking-start">book again</a>',n.forEach(function(e){this.removeItemFromCart(e).then(function(e){window.history.pushState({},"","?clear-cart=1"),location.reload()}).catch(function(e){console.error(e),window.history.pushState({},"","?clear-cart=1"),location.reload()})}.bind(this)))}else clearInterval(this.timer)},o.prototype.startCountdown=function(){var e=this,t=[];if(Object.keys(this.cart).forEach(function(e){this.cart[e]["reservation-id"]&&t.push(this.cart[e]["reservation-id"])}.bind(this)),0<t.length){var n=document.createElement("div");n.classList.add("countdown-container"),document.body.appendChild(n),document.getElementsByTagName("header")[0].classList.add("countdown-active");var i=this.getLastAddedTime();this.timer=setInterval(function(){e.countdownNext(n,i,t)},100)}};var f=o;function v(e){this.limit=e,this.leaders=[]}v.prototype.loadItems=function(){return new Promise(function(t,n){var i=this;this.getItems().then(function(e){i.leaders=e,t(e)}).catch(function(e){n(e)})}.bind(this))},v.prototype.getItems=function(){return new Promise(function(t,n){var i=new d.a,e=(i.base_url,i.api,this.limit),o=c()().format("YYYY"),a=o+"-01-01T00:00:00",r=o+"-12-31T23:59:59",s=i.base_url+"races/fastest?key="+i.api+"&start="+a+"&end="+r+"&limit="+e+"&speed_level=1";fetch(s).then(function(e){return i.checkResponse(e)}).then(function(e){return i.returnJson(e)}).then(function(e){t(e)}).catch(function(e){n(e)})}.bind(this))},v.prototype.drawItems=function(e,r){Object(h.b)(e);var t=document.createElement("table"),n=document.createElement("thead"),s=document.createElement("tbody"),i=document.createElement("tr"),o=document.createElement("th"),a=document.createTextNode("Name"),c=document.createElement("th"),u=document.createTextNode("Lap Time");o.appendChild(a),c.appendChild(u),i.appendChild(o),i.appendChild(c),n.appendChild(i),t.appendChild(n),this.leaders.fastest.forEach(function(e){var t=document.createElement("tr");r&&t.classList.add("preload");var n=document.createElement("td"),i=document.createTextNode(e.nickname);n.appendChild(i);var o=document.createElement("td"),a=document.createTextNode(e.lap_time+"s");o.appendChild(a),t.appendChild(n),t.appendChild(o),s.appendChild(t)}),t.appendChild(s),e.appendChild(t)},v.prototype.drawFastest=function(e){var t=document.createElement("div");t.classList.add("fastest-info");var n=document.createElement("h4"),i=document.createTextNode("Fastest Lap");n.appendChild(i);var o=document.createElement("p"),a=document.createTextNode(this.leaders.fastest[0].lap_time);o.appendChild(a);var r=document.createElement("h4"),s=document.createTextNode("Fastest Driver");r.appendChild(s);var c=document.createElement("p"),u=document.createTextNode(this.leaders.fastest[0].nickname);c.appendChild(u),t.appendChild(n),t.appendChild(o),t.appendChild(r),t.appendChild(c),e.prepend(t)};var p=v,g=n(12),y=n(10);function b(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function E(e,t){var n=this;this.form=e,this.formId=t,this.inputs=this.form.elements,this.name=this.inputs.name,this.email=this.inputs.email,this.phone=this.inputs.phone,this.date=this.inputs.date,this.event=this.inputs.event,this.message=this.inputs.message,this.qtyTotal=this.inputs["qty-total"],this.qtyCadets=this.inputs["qty-cadets"],this.submitButton=this.inputs.submit,this.messageContainer=null,this.setMessageContainer(),this.form.addEventListener("submit",function(e){n.bookingEnquirySubmit(e)})}E.prototype.bookingEnquirySubmit=function(e){var i=this;e.preventDefault(),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Button Click Tracking","Booking Enquiry","Submit"]),this.submitButton.disabled=!0,Object(h.a)(this.messageContainer),this.form.classList.add("submitting");var t={formid:this.formId,name:this.name.value,email:this.email.value,phone:this.phone.value,date:this.date.value,event:this.event.value,message:this.message.value,qtytotal:this.qtyTotal.value,qtycadets:this.qtyCadets.value};console.log(t),fetch("/booking-enquiry-submit",{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:t})}).then(function(e){return e.ok?Promise.resolve(e):Promise.reject(new Error(e.statusText))}).then(function(e){Object(h.b)(i.messageContainer);var t=document.createElement("div");t.classList.add("submit-success-message");var n=document.createTextNode("Thank you for your submission!");return t.appendChild(n),i.messageContainer.appendChild(t),!(i.submitButton.disabled=!1)}).catch(function(e){console.log(e)})},E.prototype.setMessageContainer=function(){b(this.form.children).forEach(function(e){e.classList.contains("message-container")&&(this.messageContainer=e)}.bind(this))};var C=E;function w(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function k(e,t){var n=this;this.form=e,this.formId=t,this.inputs=this.form.elements,this.name=this.inputs.name,this.email=this.inputs.email,this.phone=this.inputs.phone,this.date=this.inputs.date,this.message=this.inputs.message,this.participants=this.inputs.participants,this.source=this.inputs["source-page"],this.events=this.inputs["events-of-interest"],this.submitButton=this.inputs.submit,this.messageContainer=null,this.setMessageContainer(),this.form.addEventListener("submit",function(e){n.eventEnquirySubmit(e)})}k.prototype.eventEnquirySubmit=function(e){var i=this;e.preventDefault(),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Button Click Tracking","Send Us An Enquiry","Submit"]),this.submitButton.disabled=!0;var t=w(this.events).filter(function(e){return e.checked}),n=[];t.forEach(function(e){n.push(e.value)}),Object(h.a)(this.messageContainer),this.form.classList.add("submitting");var o={formid:this.formId,name:this.name.value,email:this.email.value,phone:this.phone.value,date:this.date.value,message:this.message.value,participants:this.participants.value,source:this.source.value,events:n};console.log(o),fetch("/event-enquiry-submit",{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:o})}).then(function(e){return e.ok?Promise.resolve(e):Promise.reject(new Error(e.statusText))}).then(function(e){console.info(e),Object(h.b)(i.messageContainer);var t=document.createElement("div");t.classList.add("submit-success-message");var n=document.createTextNode("Thank you for your submission!");return t.appendChild(n),i.messageContainer.appendChild(t),!(i.submitButton.disabled=!1)}).catch(function(e){console.log(e)})},k.prototype.setMessageContainer=function(){w(this.form.children).forEach(function(e){e.classList.contains("message-container")&&(this.messageContainer=e)}.bind(this))};var T=k;function N(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function I(e,t){var n=this;this.form=e,this.formId=t,this.inputs=this.form.elements,this.name=this.inputs["contact-name"],this.email=this.inputs["contact-email"],this.message=this.inputs["contact-message"],this.consent=this.inputs["contact-consent"],this.submitButton=this.inputs.submit,this.messageContainer=null,this.setMessageContainer(),this.form.addEventListener("submit",function(e){n.contactFormSubmit(e)})}I.prototype.contactFormSubmit=function(e){var i=this;e.preventDefault(),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Button Click Tracking","Leave Us A Message Form","Submit"]),this.submitButton.disabled=!0,Object(h.a)(this.messageContainer),this.form.classList.add("submitting");var t={formid:this.formId,name:this.name.value,email:this.email.value,message:this.message.value,consent:this.consent.value};console.log(t),fetch("/contact-form-submit",{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:t})}).then(function(e){return e.ok?Promise.resolve(e):Promise.reject(new Error(e.statusText))}).then(function(e){Object(h.b)(i.messageContainer);var t=document.createElement("div");t.classList.add("submit-success-message");var n=document.createTextNode("Thank you for your submission!");return t.appendChild(n),i.messageContainer.appendChild(t),!(i.submitButton.disabled=!1)}).catch(function(e){console.log(e)})},I.prototype.setMessageContainer=function(){N(this.form.children).forEach(function(e){e.classList.contains("message-container")&&(this.messageContainer=e)}.bind(this))};var O=I;if("undefined"!=typeof edge&&edge&&document.body.classList.add("edge-browser"),"undefined"!=typeof ie&&ie){document.body.classList.add("ie-browser");for(var L=document.getElementsByTagName("form"),B=0;B<L.length;B++){var j=L[B];j.classList.contains("cart")&&j.parentNode.removeChild(j)}if(-1<window.location.pathname.indexOf("booking"))for(;document.body.firstChild;)document.body.removeChild(document.body.firstChild)}if(0<document.getElementsByClassName("leaderboard_container").length){var A=document.getElementsByClassName("leaderboard_title_yyyy")[0],S=c()().format("YYYY");A.innerHTML="Leaderboard "+S;var R=document.getElementsByClassName("leaderboard_container")[0],_=document.getElementsByClassName("leaderboard_supp_info")[0];Object(h.a)(R);var q=new p(10);q.loadItems().then(function(e){q.drawItems(R,!0),q.drawFastest(_)})}if("undefined"!=typeof cartObj){var x=new f(cartObj);"undefined"!=typeof countdownTimer&&x.startCountdown()}if(document.getElementById("booking-enquiry")){var P=document.getElementById("booking-enquiry");new C(P,P.getAttribute("data-form-id"))}if(document.getElementById("event-enquiry")){var M=document.getElementById("event-enquiry");new T(M,M.getAttribute("data-form-id"))}if(document.getElementById("contact-form")){var Y=document.getElementById("contact-form");new O(Y,Y.getAttribute("data-form-id"))}if(document.getElementById("reservation-details")&&"undefined"!=typeof reservationId){var F=(new f).reservations[reservationId],D=document.getElementById("reservation-details");Object(h.a)(D),F.displaySummary(D)}0<document.getElementsByClassName("call-us-now").length&&document.getElementsByClassName("call-us-now")[0].addEventListener("click",function(e){console.log("call us link clicked"),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Phone Call Tracking","Click to Call","0191 521 4050"])})},149:function(e,t){},168:function(e,t){}});
//# sourceMappingURL=index.js.map